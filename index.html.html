<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>P-C-T Challenge ‚Äì Kh√¥ng tr√πng h·∫°ng</title>
<style>
    body{font-family:"Segoe UI",Arial;background:linear-gradient(135deg,#2193b0,#6dd5ed);color:#fff;margin:0;padding:0;display:flex;flex-direction:column;align-items:center;min-height:100vh}
    header{background:rgba(0,0,0,.2);width:100%;padding:15px 0;font-size:2em;font-weight:bold;text-align:center}
    #timerWrap{margin:20px 0;font-size:3em;color:#ffeb3b}
    #questionBox{background:#fff;color:#333;width:90%;max-width:700px;padding:25px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,.2);font-size:1.3em;text-align:center;margin-bottom:15px}
    .btnGroup button{margin:8px;padding:12px 25px;font-size:1.2em;border:none;border-radius:8px;cursor:pointer;transition:.3s}
    .btnGroup button:hover{opacity:.8}
    .P{background:#ff9800;color:#fff}
    .A{background:#4caf50;color:#fff}
    .C{background:#3f51b5;color:#fff}
    #answerWrap{margin-top:20px}
    #answerWrap input{padding:10px;font-size:1.2em;width:120px;text-align:center;border:none;border-radius:8px}
    #answerWrap button{padding:10px 20px;margin-left:10px;font-size:1.2em;border:none;border-radius:8px;background:#e91e63;color:#fff;cursor:pointer}
    #scoreBoard{display:flex;justify-content:center;gap:30px;margin-top:25px;font-size:1.4em}
    .team{display:flex;flex-direction:column;align-items:center}
    .score{font-size:1.6em;font-weight:bold;color:#ffeb3b}
    #nextBtn,#rankBtn{margin-top:25px;padding:10px 30px;background:#009688;color:#fff;font-size:1.3em;border:none;border-radius:8px;cursor:pointer}
    #solution{background:#fff;color:#333;width:90%;max-width:700px;margin-top:20px;border-radius:12px;padding:20px;display:none;font-size:1.15em;line-height:1.6}
    #rankArea{background:#fff;color:#333;width:90%;max-width:400px;margin-top:20px;border-radius:12px;padding:20px;display:none;text-align:center}
</style>
</head>
<body>

<header>P-C-T Challenge ‚Äì Kh√¥ng tr√πng h·∫°ng</header>
<div id="timerWrap">60</div>
<div id="questionBox"></div>

<div class="btnGroup">
  <button class="P" onclick="choose('P')">P ‚Äì Ho√°n v·ªã</button>
  <button class="A" onclick="choose('A')">A ‚Äì Ch·ªânh h·ª£p</button>
  <button class="C" onclick="choose('C')">C ‚Äì T·ªï h·ª£p</button>
</div>

<div id="answerWrap">
    K·∫øt qu·∫£ s·ªë: <input type="number" id="res" placeholder="?" min="0">
    <button onclick="submitAns()">G·ª≠i</button>
</div>

<div id="scoreBoard">
    <div class="team"><span>ƒê·ªôi A</span><div class="score" id="scoreA">0</div></div>
    <div class="team"><span>ƒê·ªôi B</span><div class="score" id="scoreB">0</div></div>
    <div class="team"><span>ƒê·ªôi C</span><div class="score" id="scoreC">0</div></div>
    <div class="team"><span>ƒê·ªôi D</span><div class="score" id="scoreD">0</div></div>
</div>

<button id="nextBtn" onclick="nextQ()" style="display:none">C√¢u ti·∫øp theo</button>
<button id="rankBtn" onclick="showRank()" style="display:none">X·∫øp h·∫°ng</button>

<!-- L·ªùi gi·∫£i -->
<div id="solution"></div>
<!-- B·∫£ng x·∫øp h·∫°ng -->
<div id="rankArea"></div>

<script>
const questions = [
  {q:"C√¢u 1 (Nh·∫≠n bi·∫øt): C√≥ bao nhi√™u c√°ch x·∫øp 4 b·∫°n An, B√¨nh, Chi, D≈©ng ng·ªìi v√†o 4 chi·∫øc gh·∫ø ƒë√°nh s·ªë t·ª´ 1 ƒë·∫øn 4?", ans:24, type:"P", sol:"4! = 24."},
  {q:"C√¢u 2 (Nh·∫≠n bi·∫øt): M·ªôt l·ªõp c√≥ 40 h·ªçc sinh. C·∫ßn ch·ªçn 1 l·ªõp tr∆∞·ªüng v√† 1 l·ªõp ph√≥ (hai v·ªã tr√≠ ph√¢n bi·ªát). C√≥ bao nhi√™u c√°ch?", ans:1560, type:"A", sol:"A¬≤‚ÇÑ‚ÇÄ = 1 560."},
  {q:"C√¢u 3 (Nh·∫≠n bi·∫øt): T·ª´ 5 h·ªçc sinh nam, c·∫ßn ch·ªçn ra 2 b·∫°n tham gia ƒë·ªôi c·ªï v≈© (kh√¥ng ph√¢n c·∫•p). C√≥ bao nhi√™u c√°ch?", ans:10, type:"C", sol:"C¬≤‚ÇÖ = 10."},
  {q:"C√¢u 4 (Th√¥ng hi·ªÉu): M·ªôt m·∫≠t kh·∫©u g·ªìm 3 k√≠ t·ª± kh√°c nhau ƒë∆∞·ª£c t·∫°o t·ª´ c√°c ch·ªØ c√°i A, B, C, D, E, F. C√≥ bao nhi√™u m·∫≠t kh·∫©u kh√°c nhau?", ans:120, type:"A", sol:"A¬≥‚ÇÜ = 120."},
  {q:"C√¢u 5 (V·∫≠n d·ª•ng th·∫•p): M·ªôt ƒë·ªôi b√≥ng 11 c·∫ßu th·ªß. HLV mu·ªën ch·ªçn ra 5 c·∫ßu th·ªß s√∫t lu√¢n l∆∞u v√† s·∫Øp th·ª© t·ª± t·ª´ 1 ƒë·∫øn 5. C√≥ bao nhi√™u c√°ch l·∫≠p danh s√°ch?", ans:55440, type:"A", sol:"A‚Åµ‚ÇÅ‚ÇÅ = 55 440."},
  {q:"C√¢u 6 (V·∫≠n d·ª•ng cao): C√≥ 6 nam v√† 4 n·ªØ. C·∫ßn l·∫≠p m·ªôt ƒë·ªôi g·ªìm 5 ng∆∞·ªùi c√≥ √≠t nh·∫•t 2 nam v√† √≠t nh·∫•t 1 n·ªØ. C√≥ bao nhi√™u c√°ch?", ans:240, type:"C", sol:"C‚Åµ‚ÇÅ‚ÇÄ ‚Äì (C‚Åµ‚ÇÜ + C¬π6¬∑C‚Å¥4) = 240."}
];

let currentQ = 0, timer = null, timeLeft = 60;
let teamScores = {A:0,B:0,C:0,D:0};
let teamTotalTime = {A:0,B:0,C:0,D:0};
let teamPerfect = {A:0,B:0,C:0,D:0};   // s·ªë l·∫ßn tr·∫£ l·ªùi tuy·ªát ƒë·ªëi ƒë√∫ng (10ƒë)
let chosenType = null;

function startTimer(){
    timeLeft = 60;
    document.getElementById('timerWrap').innerText = timeLeft;
    timer = setInterval(()=>{
        timeLeft--;
        document.getElementById('timerWrap').innerText = timeLeft;
        if(timeLeft <= 0){
            clearInterval(timer);
            showSolution();
        }
    },1000);
}

function choose(type){chosenType = type;}

function submitAns(){
    clearInterval(timer);
    const res = parseInt(document.getElementById('res').value);
    const correct = questions[currentQ].ans;
    const correctType = questions[currentQ].type;

    let team = prompt("Nh·∫≠p ƒë·ªôi v·ª´a tr·∫£ l·ªùi (A/B/C/D):").toUpperCase();
    if(!teamScores.hasOwnProperty(team)) return;

    let plus = 0;
    if(chosenType === correctType) plus += 5;
    if(res === correct) plus += 5;
    teamScores[team] += plus;
    teamTotalTime[team] += (60 - timeLeft);
    if(plus === 10) teamPerfect[team]++;

    document.getElementById('score'+team).innerText = teamScores[team];

    alert(`ƒê·ªôi ${team} +${plus} ƒëi·ªÉm!`);
    showSolution();
}

function showSolution(){
    const solDiv = document.getElementById('solution');
    solDiv.innerHTML = `<h3>L·ªùi gi·∫£i C√¢u ${currentQ+1}</h3><p>${questions[currentQ].sol}</p>`;
    solDiv.style.display='block';
    document.getElementById('nextBtn').style.display='inline-block';
}

function nextQ(){
    document.getElementById('solution').style.display='none';
    document.getElementById('nextBtn').style.display='none';
    currentQ++;
    if(currentQ < questions.length){
        document.getElementById('questionBox').innerText = questions[currentQ].q;
        document.getElementById('res').value='';
        chosenType=null;
        startTimer();
    }else{
        document.getElementById('questionBox').innerText="Tr√≤ ch∆°i k·∫øt th√∫c!";
        document.querySelector('.btnGroup').style.display='none';
        document.getElementById('answerWrap').style.display='none';
        document.getElementById('nextBtn').style.display='none';
        document.getElementById('rankBtn').style.display='inline-block';
    }
}

function showRank(){
    /* Ti√™u ch√≠: 1-ƒëi·ªÉm, 2-th·ªùi gian, 3-s·ªë l·∫ßn tr·∫£ l·ªùi tuy·ªát ƒë·ªëi, 4-b·ªëc thƒÉm */
    const teams = ['A','B','C','D'];
    // th√™m ch·ªâ s·ªë ng·∫´u nhi√™n ƒë·ªÉ tr√°nh b·∫±ng nhau tuy·ªát ƒë·ªëi
    teams.forEach(t => {
        if(!teamPerfect[t]) teamPerfect[t]=0;
        if(!teamTotalTime[t]) teamTotalTime[t]=0;
    });

    const sorted = teams
        .map(t => ({
            team: t,
            score: teamScores[t],
            time: teamTotalTime[t],
            perfect: teamPerfect[t],
            rand: Math.random()          // d√πng n·∫øu 3 ti√™u ch√≠ tr√™n b·∫±ng nhau
        }))
        .sort((a,b)=>{
            if(b.score !== a.score) return b.score - a.score;
            if(a.time !== b.time) return a.time - b.time;
            if(b.perfect !== a.perfect) return b.perfect - a.perfect;
            return a.rand - b.rand;
        })
        .map((o,i)=>`${i+1}. ƒê·ªôi ${o.team}: ${o.score} ƒëi·ªÉm ‚Äì ${o.time}s ‚Äì üéØ${o.perfect}`);

    const rankDiv = document.getElementById('rankArea');
    rankDiv.innerHTML = '<h2>B·∫£ng x·∫øp h·∫°ng chung cu·ªôc</h2>' +
                        '<div style="font-size:1.3em;line-height:2">' +
                        sorted.join('<br>') +
                        '</div>';
    rankDiv.style.display='block';
}

/* Kh·ªüi ch·∫°y c√¢u 1 */
document.getElementById('questionBox').innerText = questions[0].q;
startTimer();
</script>
</body>
</html>